section .data
    message db "Результат: %d", 0      ; Форматний рядок для виводу результату
    newline db 0xA, 0                  ; Перенесення рядка

section .bss
    result resd 1                      ; Змінна для результату

section .text
    global _start                      ; Точка входу програми

_start:
    ; Ініціалізація стеку
    mov rbp, rsp                       ; Встановлення базового вказівника

    ; Демонстрація операції PUSH
    push 10                            ; Додати 10 в стек
    push 20                            ; Додати 20 в стек

    ; Демонстрація операції POP
    pop rax                            ; Зчитати значення зі стеку (20)
    mov [result], rax                  ; Зберегти результат

    ; Виклик підпрограми через стек
    push 30                            ; Параметр 1
    push 40                            ; Параметр 2
    call add_two_numbers               ; Виклик підпрограми
    add rsp, 16                        ; Очищення стеку після виклику

    ; Вивід результату за допомогою системного виклику
    mov rdi, message                   ; Форматний рядок
    mov rsi, rax                       ; Результат підпрограми
    mov rax, 0x60                      ; Системний виклик sys_write
    mov rdx, 16                        ; Розмір даних для виведення
    syscall                            ; Виклик системи

    ; Завершення програми
    mov rax, 60                        ; Системний виклик для завершення
    xor rdi, rdi                       ; Код завершення 0
    syscall

add_two_numbers:
    ; Зчитування параметрів зі стеку
    pop rax                            ; Зчитати перший параметр (40)
    pop rbx                            ; Зчитати другий параметр (30)

    ; Додавання
    add rax, rbx                       ; Сума параметрів
    ret                                ; Повернення з підпрограми

